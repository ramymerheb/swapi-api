{"version":3,"sources":["./src/app/home/home.page.html","./src/app/_services/films.service.ts","./src/app/home/home-routing.module.ts","./src/app/home/home.module.ts","./src/app/home/home.page.scss","./src/app/home/home.page.ts"],"names":[],"mappings":"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","file":"home-home-module-es2015.js","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-title size=\\\"small\\\">\\n      Star Wars character list\\n    </ion-title>\\n  </ion-toolbar>\\n  <ion-searchbar\\n  (ionChange)=\\\"filter($event)\\\"\\n  *ngIf=\\\"platform.is('android')\\\"\\n  ></ion-searchbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"refresh($event)\\\">\\n    <ion-refresher-content></ion-refresher-content>\\n  </ion-refresher>\\n  \\n  <ion-header collapse=\\\"condense\\\">\\n    <ion-toolbar>\\n      <ion-title size=\\\"small\\\">\\n        Star Wars character list\\n      </ion-title>\\n    </ion-toolbar>\\n    <ion-toolbar>\\n      <ion-searchbar  style=\\\"z-index:999999999999\\\"\\n      (ionChange)=\\\"filter($event)\\\"\\n      ></ion-searchbar>\\n    </ion-toolbar>\\n  </ion-header>\\n  <h2 class=\\\"mid\\\" *ngIf =\\\"characters.length == 0 && keyword == '' && !filmsLoaded \\\">Loading Characters</h2>\\n  <ion-spinner *ngIf =\\\"characters.length == 0  && keyword == '' && !filmsLoaded \\\"></ion-spinner>\\n  <h2 class=\\\"mid\\\" *ngIf =\\\"characters.length == 0 && keyword != ''\\\">No Data Available</h2>\\n\\n  \\n  <ion-list  id=\\\"datalist\\\" #datalist>\\n    <ion-item *ngFor=\\\"let character of characters\\\"  [routerLink]=\\\"['/character/' + character.id ]\\\">\\n      <ion-label class=\\\"ion-text-wrap\\\">\\n        <h2>\\n          {{ character.name   }}\\n        </h2>\\n      </ion-label>\\n    </ion-item>\\n  </ion-list>\\n\\n  <ion-infinite-scroll threshold=\\\"50%\\\" (ionInfinite)=\\\"loadData($event)\\\">\\n    <ion-infinite-scroll-content\\n      loadingSpinner=\\\"bubbles\\\"\\n      loadingText=\\\"Loading more character...\\\">\\n    </ion-infinite-scroll-content>\\n  </ion-infinite-scroll>\\n\\n</ion-content>\";","import { Injectable } from '@angular/core';\r\nimport { HttpClient, } from '@angular/common/http';\r\nimport { environment, } from '../../environments/environment';\r\nimport { filmsList } from '../_models/films.model';\r\nimport { NativeStorage } from '@ionic-native/native-storage/ngx';\r\nimport { Platform } from '@ionic/angular';\r\nimport { Storage } from '@ionic/storage'; // This line added manually.\r\nimport { Observable } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FilmsService {\r\n  constructor(\r\n    private httpService: HttpClient,\r\n    private storage: Storage,\r\n    public platform: Platform\r\n  ) {}\r\n\r\n  getFilmsList(): Observable<any> {\r\n    let url =  environment.baseAppUrlSecure + 'films/'  ; \r\n     return this.httpService.get<filmsList>(url)\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class HomePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\n\nimport { HomePage } from './home.page';\nimport { HomePageRoutingModule } from './home-routing.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","export default \"ion-spinner {\\n  display: block;\\n  margin: auto;\\n}\\n\\n.mid {\\n  text-align: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaG9tZS9ob21lLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGNBQUE7RUFDQSxZQUFBO0FBQ0o7O0FBRUE7RUFDSSxrQkFBQTtBQUNKIiwiZmlsZSI6InNyYy9hcHAvaG9tZS9ob21lLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1zcGlubmVyIHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgbWFyZ2luOiBhdXRvO1xyXG4gIH1cclxuXHJcbi5taWQge1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gIH0iXX0= */\";","import { Component, OnInit } from '@angular/core';\nimport { character } from '../_models/characters.model';\nimport { CharactersService } from '../_services/characters.service';\nimport { environment } from '../../environments/environment';\nimport { Platform } from '@ionic/angular';\nimport { FilmsService } from '../_services/films.service';\nimport { Storage } from '@ionic/storage';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage implements OnInit {\n  nextPagePageUrl = null;\n  characters: character[];\n  keyword: string = \"\";\n  failedLoadAttempts: number = 0;\n  filmsLoaded: {};\n  dataListFillInterval: any;\n\n  constructor(\n    private charactersService: CharactersService,\n    private filmsService: FilmsService,\n    private storage: Storage,\n    public platform: Platform\n  ){\n    \n  }\n\n  ngOnInit() {\n    this.characters = []\n        //we get list of all available movies create an object of movie id and movie name and save it in local storage which will make it faster for us to assign the films of each actors\n    this.filmsService.getFilmsList().subscribe(\n      data => {\n        const filmsList = {}\n          data.results.map(\n              movie => {\n                  filmsList[ movie['episode_id'] ] = movie['title'] \n              }\n          )\n          this.storage.set('films', filmsList);\n          this.filmsLoaded = true;\n        }\n  );\n    this.tryLoadMoreData()   \n  }\n\n  //to force loading elements until the list height is greater than device-height\n   tryLoadMoreData = () => {\n    let l = document.getElementById('datalist');  \n    console.log(this.platform.height() )  \n    console.log(l.scrollHeight )  \n    console.log( l &&\n      (this.platform.height() > l.scrollHeight) && //is the list shorter than the screen\n      this.failedLoadAttempts < 20 //we should not try forever\n  )\n\n    if( l &&\n        (this.platform.height() > l.scrollHeight) && //is the list shorter than the screen\n        (this.failedLoadAttempts < 20) //we should not try forever\n    ){\n      this.getCharacters(this.nextPagePageUrl);\n      this.dataListFillInterval = setInterval(this.tryLoadMoreData, 500);\n    }else{\n      clearInterval(this.dataListFillInterval);\n    }\n  } \n  refresh(ev) {\n    this.characters = []\n    this.nextPagePageUrl=null\n    this.getCharacters(this.nextPagePageUrl, \"\");\n    ev.detail.complete();\n  }\n\n  getCharacters(nextPagePageUrl, event? ){\n    this.charactersService.getCharactersList(nextPagePageUrl, this.keyword).subscribe(\n      data => {\n        this.nextPagePageUrl = data.next\n        data.results.map(data => {\n          //to retrun the character id\n          data.id = data.url.replace(environment.baseAppUrl+'people/', \"\");\n        })\n\n        this.characters =  this.characters.concat( data.results )\n\n        if (nextPagePageUrl != null && event)\n            event.target.complete();\n        this.failedLoadAttempts ++ \n      }\n    )\n  }\n  \n  loadData(event) {\n    this.getCharacters(this.nextPagePageUrl, event);\n  }\n\n  filter(event) {\n    this.characters = []\n    this.nextPagePageUrl=null\n    this.keyword = event.detail.value;\n    this.getCharacters(this.nextPagePageUrl, \"\");\n    }\n}\n"],"sourceRoot":"webpack:///"}